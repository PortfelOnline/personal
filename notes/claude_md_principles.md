# Принципы написания хорошего CLAUDE.md (HumanLayer)

Источник: https://humanlayer.dev/blog/writing-a-good-claude-md

## Ключевые принципы

### 1. LLM — stateless функция
- Модель ничего не знает о кодовой базе в начале каждой сессии
- CLAUDE.md — единственный файл, который попадает в КАЖДЫЙ разговор
- Всё важное должно быть там (или быть доступно через него)

### 2. CLAUDE.md — онбординг Claude в проект
Должен отвечать на три вопроса:
- **WHAT**: стек, структура проекта, карта кодовой базы (особенно важно для монорепо)
- **WHY**: цель проекта, назначение разных частей
- **HOW**: как работать с проектом (bun vs node, как запускать тесты, typecheck, компиляцию)

### 3. Claude часто игнорирует CLAUDE.md
- Harness добавляет system-reminder: "may or may not be relevant to your tasks"
- Чем больше нерелевантных инструкций — тем выше шанс, что Claude проигнорирует весь файл

### 4. Меньше инструкций = лучше
- Фронтир-модели надёжно следуют ~150–200 инструкциям
- Система Claude Code уже вносит ~50 инструкций своих
- Деградация: у крупных моделей линейная, у мелких — экспоненциальная
- LLM лучше следует инструкциям в начале и конце промпта
- При росте числа инструкций Claude начинает игнорировать ВСЕ равномерно

### 5. Содержимое должно быть универсально применимым
- Не включай инструкции, которые нужны только для одной задачи (например, структура схемы БД)
- Рекомендуемая длина: < 300 строк, лучше — меньше 60

### 6. Progressive Disclosure (прогрессивное раскрытие)
- Держи специфичные инструкции в отдельных markdown-файлах:
  ```
  agent_docs/
    |- building_the_project.md
    |- running_tests.md
    |- code_conventions.md
    |- service_architecture.md
  ```
- В CLAUDE.md — только список этих файлов с кратким описанием
- Claude сам решает, какие из них читать для текущей задачи
- **Указывай ссылки, не копии** — `file:line` вместо сниппетов кода (сниппеты устаревают)

### 7. Claude — не линтер
- Никогда не посылай LLM делать работу линтера/форматтера
- Линтеры: детерминированы, быстры, дёшевы
- Вместо этого:
  - Настрой Claude Code Stop Hook для запуска линтера/форматтера
  - Используй авто-фиксящие линтеры (например, Biome)
  - Создай Slash Command для проверки стиля отдельно от реализации
- LLM — in-context learner: если код следует паттернам, Claude их подхватит сам

### 8. Не используй /init и авто-генерацию
- CLAUDE.md — наивысшая точка рычага в harness
- Влияет на КАЖДУЮ фазу работы и КАЖДЫЙ артефакт
- Плохая строка в CLAUDE.md → плохой план → много плохого кода
- Тщательно продумывай каждую строку вручную

## Итог
- CLAUDE.md = онбординг. Отвечает на WHY, WHAT, HOW
- Как можно меньше инструкций, только универсальные
- Прогрессивное раскрытие через отдельные файлы
- Claude — не линтер, используй правильные инструменты
- Не авто-генерируй — вкладывай в это время и мысль
